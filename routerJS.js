Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1}),Array.prototype.remove||(Array.prototype.remove=function(e){var t=this.indexOf(e);t!==-1&&this.splice(t,1)}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("routerJS requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=document.createElement("a");return t.href=e,t.hostname!=v}function r(e){var t=document.createElement("a");t.href=e;var n=t.pathname;/^\//.exec(n)||(n="/"+n);for(var r=location.pathname.split("/"),o=n.split("/"),i=0,a=Math.max(r.length,o.length),s=1;s<a;s++)r[s]&&o[s]&&r[s]==o[s]&&i++;return R.path_depth=i,n!=location.pathname}function o(e){return"[object String]"===x.call(e)}function i(e){return"[object Function]"===x.call(e)}function a(e){return"[object Array]"===x.call(e)}function s(e){return"[object Object]"===x.call(e)}function c(e){return l(u(e))}function u(e){e||(e=location.search);var t={};e=decodeURIComponent(e.substr(1));for(var n=e.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");t[o[0]]=o[1]}return t}function l(e){var t=[];if(!s(e))return t;for(var n in e)t.push(n+"="+e[n]);return t.sort(),t&&(t="?"+t.join("&")),t}function h(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function f(e,t){return b.call(e,t)}function p(e,t){var n;for(n in e)if(f(e,n)&&t(e[n],n))break}function d(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=e||{};for(var o=0,i=n.length,c=void 0,u=void 0,l=void 0,h=void 0;o<i;o++)if(c=n[o])for(u in c)l=e[u],h=c[u],l&&l===h||(s(h)?e[u]=d(l&&s(l)?l:{},h):a(h)?e[u]=d([],h):e[u]=h);return e}function g(e,t,n){n=n||{},t=t||[];var r,o=n.strict,i=n.end!==!1,s=n.sensitive?"":"i",c=0,u=t.length,l=0,h=0;if(e instanceof RegExp){for(;r=q.exec(e.source);)t.push({name:h++,optional:!1,offset:r.index});return e}if(a(e))return e=e.map(function(e){return g(e,t,n).source}),new RegExp("(?:"+e.join("|")+")",s);for(e=("^"+e+(o?"":"/"===e[e.length-1]?"?":"/?")).replace(/\/\(/g,"/(?:").replace(/([\/\.])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(e,n,r,o,i,a,s,u){n=n||"",r=r||"",i=i||"([^\\/"+r+"]+?)",s=s||"",t.push({name:o,optional:!!s,offset:u+c});var l=""+(s?"":n)+"(?:"+r+(s?n:"")+i+(a?"((?:[\\/"+r+"].+?)?)":"")+")"+s;return c+=l.length-e.length,l}).replace(/\*/g,function(e,n){for(var r=t.length;r-- >u&&t[r].offset>n;)t[r].offset+=3;return"(.*)"});r=q.exec(e);)(u+l===t.length||t[u+l].offset>r.index)&&t.splice(u+l,0,{name:h++,optional:!1,offset:r.index}),l++;return e+=i?"$":"/"===e[e.length-1]?"":"(?=\\/|$)",new RegExp(e,s)}var m=document.head||document.getElementsByTagName("head")[0],y=location,v=y.hostname,S=Object.prototype,x=S.toString,b=S.hasOwnProperty,j={css:/\.css([\#\?]{1}.*)?$/,js:/\.js([\#\?]{1}.*)?$/},w={},C=[],q=/\((?!\?)/g,R=function(e){return e||(e=v),R[e]||(R[e]=new R.init(e)),R[e]};R.fn=R.prototype={config:function(t){this.router={},this.fileMap={},this.libs={},this.config=d({revSuffix:"-[0-9a-f]{8,10}-?",prefix:R.prefix},t),this.config.onStart&&i(this.config.onStart)||(this.config.onStart=function(){}),this.config.revSuffix=new RegExp(this.config.revSuffix);var n=this.config.onStart;R.history&&!e._historyPushState&&"pushState"in history&&(e._historyPushState=History.prototype.pushState,e._historyReplaceState=History.prototype.replaceState,History.prototype.pushState=function(e,t,r){return!R.changeUrl(location.href,r).hash&&(n(e,t,r),_historyPushState.call(this,e,t,r),R.load())},History.prototype.replaceState=function(e,t,r){return!R.changeUrl(location.href,r).hash&&(n(e,t,r),_historyReplaceState.call(this,e,t,r),R.load())},e.addEventListener("popstate",function(e){return!R.changeUrl(location.href,R.oldpath).hash&&(n(),R.load())}))},set:function(e,t){this.router[e]=t},makeItem:function(e,t,r){var i=this.fileMap,s=this,c=this.makeItem,u=this.libs,l=this.config.prefix,f={js:s.config.jsPath,css:s.config.cssPath};if(a(e)){if(r)return R.error("jsMap do not use Array Object.");var p=[];return h(e,function(e){p.push(c.call(s,e,t))}),p}var g=(this.config.jsPath||"",this.config.revSuffix),i=this.fileMap,m={type:t||"js"};if(m.path=e.path||o(e)&&e,m.name=r||e.name||m.path.replace(j[m.type],"").replace(g,""),!m.name)return R.error("not name ");if("js"==m.type&&i[m.name])return d({},i[m.name]);m.path=f[m.type]+m.path.replace(j[m.type],"")+"."+m.type,m.isremote=n(m.path);var y=l+m.name+"."+m.type;return u[y]=1,"js"!=t?m:(m.children=[],m.require=o(e.require)&&[e.require]||a(e.require)&&e.require||[],e.when&&(m.when=e.when),m)},makeMap:function(){var e=this,t=this.config.jsMap,n=this.router,r=this.fileMap,o=this.makeItem;p(t,function(t,n){var i=o.call(e,t);i&&(r[n]=o.call(e,t,"js",n))}),p(n,function(t,n){t.css&&(a(t.css)||(t.css=[t.css]),t.css=o.call(e,t.css,"css")),t.js&&(a(t.js)||(t.js=[t.js]),t.js=o.call(e,t.js,"js"))})},makeThisPage:function(){function e(t,n){return h(t,function(t){f(w,t)||(w[t]=o[t]),w[t].children||(w[t].children=[]),w[t].children.indexOf(n)==-1&&w[t].children.push(n),w[n].require||(w[n].require=[]),w[n].require.indexOf(t)==-1&&w[n].require.push(t),C.indexOf(t)==-1&&C.push(t),w[t].require&&w[t].require.length&&e(w[t].require,t)})}var t=location.pathname,n={},r=(this.config.cssPath||"",this.config.jsPath||"",d({},this.router)),o=this.fileMap;this.config.revSuffix,this.libs,this.config.prefix;w={},R.thisCbs=[],C=[],R.allReadyed=!1,this.config.cb&&i(this.config.cb)&&R.thisCbs.push(this.config.cb),p(r,function(e,r){var o=g(r);o.exec(t)&&(e.cb&&i(e.cb)&&R.thisCbs.push(e.cb),e.css&&h(e.css,function(e){n[e.name]=e}),e.js&&h(e.js,function(e){w[e.name]=e}))}),p(w,function(t,n){C.indexOf(n)==-1&&C.push(n),t.require&&t.require.length&&e(t.require,n)}),0==C.length&&R.thisCbs.length&&h(R.thisCbs,function(e){e()}),p(w,function(e,t){return R.loadedJS[t]?(w[t].status="ready",R.push(t),!1):w[t].when&&i(w[t].when)&&!w[t].when()?(w[t].status="ready",R.push(t),!1):void R.get(e,function(e,n){e&&(w[t].source=e.source,w[t].status="loaded"),n&&(w[t].status="pending"),w[t].el=R.createJS(w[t]),R.push(t)})}),h(R.loadedCSS,function(e){n.indexOf(e)==-1&&m.removeChild(R.loadedCSS[e])}),p(n,function(e,t){R.loadedCSS[t]||R.get(e,function(n,r){R.loadedCSS[t]=R.createCSS(n||e),m.appendChild(R.loadedCSS[t])})})},run:function(){this.makeMap(),this.load()},load:function(){R.isRedirect=r(R.oldpath),R.isVirgin===!0?R.isVirgin=1:R.isVirgin=!1,R.oldpath==location.href&&R.thisCbs.length?h(R.thisCbs,function(e){e()}):(R.oldpath=location.href,this.makeThisPage(),this.clear())},clear:function(){var t=this.config.prefix,n=this.libs;!!e.localStorage&&p(localStorage,function(e,r){0!=r.indexOf(t)||n[r]||localStorage.removeItem(r)})}},d(R,{debug:!1,isVirgin:!0,isRedirect:!1,history:!1,allReadyed:!1,loadedCSS:{},loadedJS:{},oldpath:location.href,thisCbs:[],prefix:"routerI_",error:function(e){throw new Error(e)},changeUrl:function(e,t){var n=document.createElement("a");n.href=e;var r=document.createElement("a");r.href=t;var o=n.hostname,i=n.pathname,a=n.href,s=n.hash||a.replace(/([^\#]*)/,""),u=(a.replace(s,""),c(this.search)),l=r.hostname,h=r.pathname,f=r.href,p=r.hash||f.replace(/([^\#]*)/,""),d=(f.replace(p,""),c(r.search));return{hostname:!(o==l),href:!(o==l&&i==h&&u==d),hash:o==l&&i==h&&u==d&&s!=p}},createJS:function(e){var t=document.createElement("script");return t.type="text/javascript",e.source?(R.debug&&(t.title=e.name),"object"==typeof document.textContent?(t.textContent=e.source,t):(t.text=e.source,t)):(t.src=e.path,t)},createCSS:function(e){var t;return e.source?(t=document.createElement("style"),t.type="text/css","object"==typeof document.textContent?(t.textContent=e.source,t):(t.styleSheet.cssText=e.source,t)):(t=document.createElement("link"),t.rel="stylesheet",t.type="text/css",t.href=e.path,t)},getStrage:function(t){var n=R.prefix+t.name+"."+t.type;return!!e.localStorage&&localStorage.getItem(n)},setStorage:function(t){var n=R.prefix+t.name+"."+t.type,r=JSON.stringify(t);return!!e.localStorage&&localStorage.setItem(n,r)},get:function(t,n){var r,o=R.getStrage(t);try{r=JSON.parse(o)}catch(i){return n(null,i)}if(r&&r.source&&r.path&&r.path==t.path&&!r.error)return n(r);var a,s;t.name;try{a=new XMLHttpRequest}catch(i){}if(t.isremote||a||!e.ActiveXObject||(a=new ActiveXObject("Microsoft.XMLHTTP")),t.isremote&&"undefined"!=typeof XDomainRequest&&(a=new XDomainRequest,s="XDR"),!a)return n(null,"maybe not-allow-cors");if(a)if("XDR"==s)a.timeout=1e4,a.open("get",t.path),a.onprogress=function(){},a.ontimeout=function(){n(null,"timeout")},a.onerror=function(e){n(null,"not-allow-cors")},a.onload=function(){t.source=a.responseText,R.setStorage(t),n(t)},setTimeout(function(){a.send()},0);else try{a.onreadystatechange=function(e){4==a.readyState&&(200==a.status||304==a.status?(t.source=a.responseText,R.setStorage(t),n(t)):t.isremote&&0===a.status?n(null,"not-allow-cors"):n(null,a.status))},a.open("get",t.path,!0),a.send(null)}catch(i){return n(null,i)}},push:function(e,t){var n=w[e];if(n){if(n.require&&n.require.length){var r;if(h(n.require,function(e){w[e]&&(r=!0),w[e]||n.require.remove(e)}),r&&"ready"!=n.status)return}"ready"==n.status&&R.allReady(n),"loaded"==n.status&&(R.loadedJS[n.name]=1,m.appendChild(n.el),R.allReady(n)),"pending"==n.status&&(n.el.onload=n.el.onreadystatechange=function(e){n.el.readyState&&"loaded"!=n.el.readyState&&"complete"!=n.el.readyState||(R.loadedJS[n.name]=1,R.allReady(n))},m.appendChild(n.el))}},allReady:function(e){var t=d([],e.children);delete w[e.name],C.remove(e.name),t.length&&h(t,function(t){w[t]&&(w[t].require.remove(e.name),R.push(t))}),C.length<=0&&R.thisCbs.length&&!R.allReadyed&&(R.allReadyed=!0,h(R.thisCbs,function(e){e()}))},load:function(){return R[v]&&R[v].load()}});var O=R.init=function(e){return this};O.prototype=R.fn,"function"==typeof define&&define.amd&&define("routerjs",[],function(){return R});var E="undefined";return typeof t===E&&(e.routerJS=e.RJS=R),R});
//# sourceMappingURL=map/routerJS.js.map
